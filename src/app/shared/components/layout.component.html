<div class="app-shell" [class.app-shell--collapsed]="collapsed()">
  <aside class="sidebar">
    <div class="sidebar__brand">
      <button class="icon-button" type="button" (click)="toggleCollapse()"
        [attr.aria-label]="collapsed() ? 'Expand sidebar' : 'Collapse sidebar'">
        @if (collapsed()) {
        <!-- Arrow Right when collapsed (suggesting open) -->
        <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden>
          <path fill="currentColor" d="M10 6l6 6-6 6V6zM8 6h2v12H8V6z" />
        </svg>
        } @else {
        <!-- Arrow Left when expanded (suggesting collapse) -->
        <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden>
          <path fill="currentColor" d="M14 6v12l-6-6 6-6zm2 0h-2v12h2V6z" />
        </svg>
        }
      </button>
      <span class="sidebar__title">Budget</span>
    </div>
    <nav class="sidebar__nav">
      <a routerLink="/config" class="sidebar__link" routerLinkActive="is-active">
        <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden>
          <path fill="currentColor" d="M12 2a10 10 0 100 20 10 10 0 000-20zm1 11h5v2h-7V7h2v6z" />
        </svg>
        <span class="sidebar__label">Settings</span>
      </a>
      <a routerLink="/transactions" class="sidebar__link" routerLinkActive="is-active">
        <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden>
          <path fill="currentColor" d="M3 6h18v2H3V6zm0 5h18v2H3v-2zm0 5h18v2H3v-2z" />
        </svg>
        <span class="sidebar__label">Transactions</span>
      </a>
      <a routerLink="/activity" class="sidebar__link" routerLinkActive="is-active">
        <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden>
          <path fill="currentColor" d="M4 4h16v2H4V4zm0 6h10v2H4v-2zm0 6h16v2H4v-2z" />
        </svg>
        <span class="sidebar__label">Activity</span>
      </a>
    </nav>
    <div class="sidebar__footer"></div>
  </aside>
  <main class="content">
    <div class="content__header">
      <div class="content__header-spacer"></div>
      <div class="content__header-actions">
        <button class="icon-button" type="button" (click)="theme.toggle()"
          [attr.aria-label]="theme.theme() === 'dark' ? 'Switch to light theme' : 'Switch to dark theme'"
          title="Toggle theme">
          @if (theme.theme() === 'light') {
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
            stroke-linejoin="round" aria-hidden>
            <circle cx="12" cy="12" r="4" />
            <path
              d="M12 2v2m0 16v2M4.93 4.93l1.41 1.41m11.32 11.32l1.41 1.41M2 12h2m16 0h2M4.93 19.07l1.41-1.41m11.32-11.32l1.41-1.41" />
          </svg>
          } @else {
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
            stroke-linejoin="round" aria-hidden="true">
            <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z" />
          </svg>
          }
        </button>
        <button class="button button--ghost button--sm" type="button" (click)="gotoSettings()" title="Open settings">{{ displayName() }}</button>
        <button class="button button--ghost button--sm" type="button" (click)="logout()">Logout</button>
      </div>
    </div>
    <router-outlet></router-outlet>
  </main>
</div>
@if (ui.isLoading()) {
<div class="overlay">
  <div class="spinner" aria-label="Loading"></div>
</div>
}

<div class="toasts">
  @for (t of ui.toasts(); track t.id) {
  <div class="toast" [class.toast--success]="t.type==='success'" [class.toast--error]="t.type==='error'">{{ t.message }}
  </div>
  }
</div>
